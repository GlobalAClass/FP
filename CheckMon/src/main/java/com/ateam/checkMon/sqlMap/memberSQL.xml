<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="checkMonMember">
	<insert id="addEmpJoinSQL" parameterType="com.ateam.checkMon.member.model.EmpDTO">
		insert into
			Emp_TB
		values(
			Emp_TB_SEQ.nextval,
			null,
			#{e_email},
			#{e_pwd},
			#{e_name},
			#{e_tel},
			#{e_birthDay},
			null,
			null,
			null,
			null
		)
	</insert>
	
	<select id="empIdCheckSQL" parameterType="String" resultType="String">
		select E_EMAIL from EMP_TB 
		where E_EMAIL=#{e_email}
	</select>
	
	<update id="addEmpPwdSQL" parameterType="com.ateam.checkMon.member.model.EmpDTO">
		update emp_tb 
		set e_rpwd=#{e_rpwd}
		where e_email=#{e_email}
	</update>
	
	<select id="empAutoLoginSQL" parameterType="String" resultType="String">
		select e_rpwd 
		from emp_tb 
		where e_email=#{e_email}
	</select>
	
	<insert id="addManJoinSQL" parameterType="com.ateam.checkMon.member.model.ManDTO">
		insert into
			Man_TB
		values(
			#{man_ix},
			#{m_email},
			#{m_pwd},
			#{m_name},
			#{m_tel},
			#{corporate_number},
			null
		)
	</insert>
	
	<update id="addManPwdSQL" parameterType="com.ateam.checkMon.member.model.ManDTO">
		update man_tb 
		set m_rpwd=#{m_rpwd}
		where m_email=#{m_email}
	</update>
	
	<select id="manAutoLoginSQL" parameterType="String" resultType="String">
		select m_rpwd 
		from man_tb 
		where m_email=#{m_email}
	</select>
	
	<select id="getNextManIxSQL" resultType="int">
		select man_tb_seq.nextval from dual
	</select>
	
	<insert id="addStoreManJoinSQL" parameterType="com.ateam.checkMon.member.model.StoreDTO">
		insert into
			Store_TB
		values(
			store_tb_seq.nextval,
			#{store_name},
			#{store_addr},
			#{m_latitude},
			#{m_longitude},
			#{man_ix}
		)
	</insert>
	
	<select id="manIdCheckSQL" parameterType="String" resultType="String">
		select M_EMAIL from Man_TB 
		where M_EMAIL=#{m_email}
	</select>
	
	<select id="empLoginSQL" parameterType="map" resultType="com.ateam.checkMon.member.model.EmpDTO">
		select e_email,e_pwd
		from emp_tb
		where e_email=#{e_email}
		and e_pwd=#{e_pwd}
	</select>
	
	<select id="empNameSQL" parameterType="String" resultType="String">
		select e_name
		from emp_tb
		where e_email=#{e_email}
	</select>
	
	<select id="manLoginSQL" parameterType="map" resultType="com.ateam.checkMon.member.model.ManDTO">
		select m_email,m_pwd
		from man_tb
		where m_email=#{m_email}
		and m_pwd=#{m_pwd}
	</select>
	
	<select id="manNameSQL" parameterType="String" resultType="String">
		select m_name
		from man_tb
		where m_email=#{m_email}
	</select>
	<select id="checkQRAndStorIxSQL" parameterType="map" resultType="int">
		select 1 from man_tb m, emp_tb e 
		where m.man_ix = e.man_ix and e.e_email=#{e_email} and store_ix = #{storeIx}
	</select>
	<select id="getStoreListSQL" parameterType="String" resultType="com.ateam.checkMon.member.model.StoreDTO">
		select *
		from store_tb
		where store_name like '%'||#{searchStore}||'%'
	</select>
</mapper>